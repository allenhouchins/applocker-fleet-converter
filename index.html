<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AppLocker to Fleet Converter</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîí AppLocker to Fleet Converter</h1>
            <p class="subtitle">Convert your AppLocker XML policies to Fleet-compatible MDM format</p>
        </header>

        <div class="steps-info">
            <h2>How to Create and Export Your AppLocker Policy</h2>
            <div class="instructions">
                <h3>Step 1: Open AppLocker Management</h3>
                <p>You can use either:</p>
                <ul>
                    <li><strong>Local Security Policy</strong> (for local policies): Press <code>Win + R</code>, type <code>secpol.msc</code> and press Enter</li>
                    <li><strong>Group Policy Management Console</strong> (for domain policies): Open from Administrative Tools</li>
                </ul>

                <h3>Step 2: Navigate to AppLocker</h3>
                <p>In the left pane, navigate to: <strong>Application Control Policies ‚Üí AppLocker</strong></p>

                <h3>Step 3: Create Your Rules</h3>
                <p>Right-click on any of the following rule types and select <strong>Create New Rule</strong>:</p>
                <ul>
                    <li><strong>Executable Rules</strong> (EXE files)</li>
                    <li><strong>Windows Installer Rules</strong> (MSI files)</li>
                    <li><strong>Script Rules</strong> (PowerShell, VBScript, etc.)</li>
                    <li><strong>DLL Rules</strong> (Dynamic Link Libraries)</li>
                    <li><strong>Packaged app Rules</strong> (StoreApps)</li>
                </ul>
                <p>Follow the wizard to create your rules. Remember: when creating allow lists, you must explicitly allow system apps like Settings, Start, Email, etc., as all inbox apps are blocked by default.</p>

                <h3>Step 4: Export the Policy</h3>
                <p>Right-click on <strong>AppLocker</strong> in the left pane and select <strong>Export Policy...</strong>. Choose a location and save as XML (e.g., <code>applocker-policy.xml</code>).</p>

                <h3>Step 5: Convert Using This Tool</h3>
                <p>Upload or paste your exported XML file below. The tool will automatically detect which rule types are available in your policy and enable/disable the appropriate options.</p>
                
                <h3>Step 6: Verify Policy Deployment</h3>
                <p>After deploying via Fleet, verify the policy is applied:</p>
                <ul>
                    <li><strong>In Fleet:</strong> Check policy status and device compliance in the Fleet console</li>
                    <li><strong>Test (Most Reliable):</strong> Try running a blocked application - if you see the "This app has been blocked" dialog, the policy is working correctly</li>
                    <li><strong>Event Viewer:</strong> Check Applications and Services Logs ‚Üí Microsoft ‚Üí Windows ‚Üí AppLocker for deployment events (Event ID 8003) and block events (Event ID 8004)</li>
                    <li><strong>Note:</strong> Policies deployed via MDM may not always be visible in Local Security Policy GUI, but they are still active and working if apps are being blocked</li>
                </ul>
                
                <h3>What Users Will See</h3>
                <p>When an AppLocker policy blocks an application, end users will see a Windows dialog box indicating that the app has been blocked by their system administrator:</p>
                <div class="screenshot-container">
                    <img src="applocker-blocked-dialog.png" alt="AppLocker blocked dialog shown to end users" class="screenshot">
                    <p class="screenshot-caption">Example of the dialog shown to users when an application is blocked by AppLocker</p>
                </div>
                
                <div class="important-note">
                    <strong>‚ö†Ô∏è Important:</strong> Always test AppLocker policies on a small group of devices before deploying organization-wide. Some policy changes may require a device reboot.
                </div>
            </div>
        </div>

        <div class="converter-section">
            <div class="input-section">
                <h2>Step 1: Input AppLocker XML</h2>
                <div class="input-options">
                    <label class="file-upload">
                        <input type="file" id="fileInput" accept=".xml" />
                        <span class="upload-button">üìÅ Upload XML File</span>
                    </label>
                    <span class="divider">or</span>
                    <button id="pasteBtn" class="paste-button">üìã Paste XML</button>
                </div>
                <textarea id="xmlInput" placeholder="Paste your AppLocker XML here, or upload a file above..."></textarea>
            </div>

            <div class="options-section">
                <h2>Step 2: Select Rule Types</h2>
                <p class="help-text">Select which rule collections you want to include in the Fleet policy:</p>
                <div class="rule-checkboxes">
                    <label><input type="checkbox" id="exe" checked> EXE (Executables)</label>
                    <label><input type="checkbox" id="msi"> MSI (Windows Installer)</label>
                    <label><input type="checkbox" id="script"> Script</label>
                    <label><input type="checkbox" id="dll"> DLL</label>
                    <label><input type="checkbox" id="storeapps"> StoreApps</label>
                </div>
                <div class="grouping-section">
                    <label for="grouping">Grouping ID:</label>
                    <input type="text" id="grouping" value="FleetAppLocker" placeholder="FleetAppLocker">
                    <span class="help-text-small">Unique identifier for this policy. Microsoft recommends using a GUID to avoid conflicts. Generate one in PowerShell: <code>[guid]::NewGuid()</code></span>
                </div>
                <div class="important-note" style="margin-top: 20px;">
                    <strong>‚ö†Ô∏è Critical - Atomic Policy Deployment:</strong> MDM-deployed AppLocker policies are <strong>atomic</strong> - each deployment completely replaces any previous policy with the same Grouping ID. <strong>You have two options:</strong><br><br>
                    <strong>Option 1 (Recommended):</strong> Include <strong>ALL your rules (new and old) in a single policy deployment</strong>. When adding new rules, export the complete updated policy and redeploy.<br><br>
                    <strong>Option 2:</strong> Use a <strong>new Grouping ID</strong> for each new policy to create separate policy instances that coexist. Example: Deploy Policy A (blocks App1) with Grouping ID "FleetAppLocker" ‚Üí Deploy Policy B (blocks App2) with NEW Grouping ID "FleetAppLocker2" ‚Üí Both policies are active.
                </div>
            </div>

            <div class="action-section">
                <button id="convertBtn" class="convert-button" disabled>üîÑ Convert to Fleet Format</button>
                <button id="downloadBtn" class="download-button" disabled>üíæ Download SyncML File</button>
            </div>

            <div class="output-section" id="outputSection" style="display: none;">
                <h2>Step 3: Preview Output</h2>
                <div class="output-controls">
                    <button id="copyBtn" class="copy-button">üìã Copy to Clipboard</button>
                    <button id="clearBtn" class="clear-button">üóëÔ∏è Clear</button>
                </div>
                <pre id="output"><code></code></pre>
            </div>

            <div class="error-section" id="errorSection" style="display: none;">
                <div class="error-message" id="errorMessage"></div>
            </div>
        </div>

        <footer>
            <p>Made for Windows admins deploying AppLocker policies via Fleet</p>
            <p class="docs-link">
                <a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/applocker-csp" target="_blank">
                    üìö Microsoft AppLocker CSP Documentation
                </a>
            </p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>

